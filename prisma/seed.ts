import { PrismaClient, Gender } from '../src/generated/prisma';

const prisma = new PrismaClient();

const toSlug = (name: string) =>
  name
    .toLowerCase()
    .replace(/ /g, '-')
    .replace(/[^\w-]+/g, '');

async function main() {
  console.log('üå± D√©marrage du seed...');

  console.log('üî• Purge de la base de donn√©es...');
  await prisma.favorite.deleteMany();
  await prisma.product.deleteMany();
  await prisma.category.deleteMany();
  await prisma.brand.deleteMany();
  await prisma.user.deleteMany();
  console.log('üî• Base de donn√©es purg√©e.');

  const testUser = await prisma.user.create({
    data: {
      id: 'user_test_gda',
      name: 'Test User GDA',
      email: 'test.gda@example.com',
    },
  });
  console.log(`üë§ Utilisateur de test cr√©√©: ${testUser.name}`);

  const brandData = [
    { name: 'Jean Couturier', description: 'Parfums de luxe et cr√©ations olfactives.' },
    { name: 'Fragranza', description: 'Cr√©ateur de parfums rares et pr√©cieux.' },
    { name: 'Maison Massimo', description: 'L\'excellence de la parfumerie de niche.' },
    { name: 'Stephane Humbert Lucas 777', description: 'Haute parfumerie, luxe et spiritualit√©.' },
    { name: 'Les Liquides Imaginaires', description: 'Parfums comme des √©nigmes.' },
    { name: 'Rosendo Mateu', description: 'Ma√Ætre parfumeur, cr√©ations d\'exception.' },
    { name: 'Mancera', description: 'Intensit√© des parfums d\'orient, modernit√© fran√ßaise.' },
    { name: 'Montale', description: 'Les tr√©sors olfactifs de l\'Arabie.' },
    { name: 'Kajal', description: 'Luxe et √©l√©gance inspir√©s par la beaut√©.' },
    { name: 'Nishane', description: 'Premi√®re maison de parfum de niche d\'Istanbul.' },
    { name: 'Atelier des Ors', description: 'Haute parfumerie po√©tique.' },
    { name: 'Les Princes Du Golfe', description: 'Les senteurs envo√ªtantes du Golfe.' },
    { name: 'Maison Berliner', description: 'Parfums de cr√©ateur, audacieux et contemporains.' },
  ];

  await prisma.brand.createMany({
    data: brandData.map((b) => ({ ...b, slug: toSlug(b.name), website: '' })),
  });
  const brands = await prisma.brand.findMany();
  const brandMap = new Map(brands.map((b) => [b.name, b.id]));
  console.log(`üè∑Ô∏è ${brands.length} marques cr√©√©es.`);

  const categoryData = [
    { name: 'Gourmand', description: 'Parfums aux notes sucr√©es et app√©tissantes.' },
    { name: 'Fruit√©', description: 'Senteurs fra√Æches et vives de fruits.' },
    { name: 'Floral', description: 'Bouquets de fleurs, du plus l√©ger au plus opulent.' },
    { name: 'Oriental', description: 'Accords chauds, sensuels et √©pic√©s.' },
    { name: 'Frais', description: 'Notes hesp√©rid√©es, aquatiques et vertes.' },
    { name: 'Bois√©', description: 'Senteurs de bois, de la for√™t au bois pr√©cieux.' },
    { name: '√âpic√©', description: 'Caract√®re et chaleur des √©pices du monde.' },
  ];
  await prisma.category.createMany({
    data: categoryData.map((c) => ({ ...c, slug: toSlug(c.name) })),
  });
  const categories = await prisma.category.findMany();
  const categoryMap = new Map(categories.map((c) => [c.name, c.id]));
  console.log(`üìÇ ${categories.length} cat√©gories cr√©√©es.`);

  const productsData = [
    {
      name: 'Vanilla Exotica',
      description: 'Un aller simple vers une √Æle paradisiaque. Vanille solaire, fleurs exotiques et coco soyeuse‚Ä¶ Ce parfum, c‚Äôest la caresse d‚Äôun coucher de soleil sur peau sal√©e. Id√©al pour celles et ceux qui veulent sentir l‚Äô√©t√© toute l‚Äôann√©e.',
      price: 70,
      volume: 100,
      topNotes: ['noix de coco', 'p√™che', 'muguet'],
      heartNotes: ['jasmin', 'ylang-ylang', 'fleur de tiar√©', 'sucre de canne'],
      baseNotes: ['vanille', 'bois de santal', 'musc'],
      brandId: brandMap.get('Jean Couturier')!,
      categoryId: categoryMap.get('Gourmand')!,
    },
    {
      name: 'Coeur Blanc',
      description: 'Un moment suspendu, comme une √©treinte au petit matin. La coco fondante, la vanille caressante et le musc blanc d√©licat enveloppent la peau d‚Äôun nuage tendre et lumineux. C‚Äôest la douceur d‚Äôun instant intime‚Ä¶ rien que pour vous.',
      price: 70,
      volume: 100,
      topNotes: ['noix de coco cr√©meuse (de Tahiti)', 'vanille sucr√©e (de Madagascar)'],
      heartNotes: ['bois de c√®dre √©l√©gant'],
      baseNotes: ['musc blanc pur et enveloppant'],
      brandId: brandMap.get('Fragranza')!,
      categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'La Rose Bleue',
        description: 'Rose Bleu, c\'est la fra√Æcheur d\'un matin lumineux, o√π les agrumes √©clatent comme un sourire. Un c≈ìur doux et fruit√© glisse vers un fond musqu√©, chaud et r√©confortant.',
        price: 100,
        volume: 100,
        topNotes: ['orange', 'bergamote', 'citron'],
        heartNotes: ['notes fruit√©es', 'florales et sucr√©es'],
        baseNotes: ['muscs blancs', 'ambre vanill√©', 'bois de c√®dre'],
        brandId: brandMap.get('Maison Massimo')!,
        categoryId: categoryMap.get('Floral')!,
    },
    {
        name: 'Gold Signature',
        description: 'Gold Signature incarne l\'√©l√©gance chaleureuse et lumineuse. Une ouverture fra√Æche et √©pic√©e qui r√©v√®le un c≈ìur floral d√©licat, pos√© sur un fond riche, vanill√© et bois√©. Parfait pour marquer les moments pr√©cieux avec raffinement et charisme.',
        price: 100,
        volume: 100,
        topNotes: ['bergamote', 'citron', 'poivre rose'],
        heartNotes: ['jasmin', 'fleur d\'oranger', 'rose'],
        baseNotes: ['bois de santal', 'patchouli', 'vanille', 'ambre'],
        brandId: brandMap.get('Maison Massimo')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Soleil de Jeddah Mango Kiss',
        description: 'Soleil de Jeddah Mango Kiss est une invitation √† un voyage paradisiaque. Les notes acidul√©es de mandarine et de mangue p√©tillent d√®s l\'ouverture, tandis que la fra√Æcheur d\'un sorbet coco contraste avec les facettes sucr√©es de l\'ylang-ylang. Une douceur addictive d\'ambre solaire et d\'absolu de vanille sublime les gourmandises fac√©tieuses.',
        price: 190,
        volume: 50,
        topNotes: ['Mangue', 'Huile de Camomille Sauvage', 'Fleur d\'Oranger'],
        heartNotes: ['Ylang Ylang', 'Ambre', 'Noix de Coco'],
        baseNotes: ['Beurre d\'iris', 'Benjoin de Siam', 'Vanille de Madagascar'],
        brandId: brandMap.get('Stephane Humbert Lucas 777')!,
        categoryId: categoryMap.get('Fruit√©')!,
    },
    {
        name: 'Blanche Bete',
        description: 'Blanche B√™te est une invitation √† un voyage sensoriel dans un jardin f√©erique, o√π la puret√© d\'un cheval mythique se m√™le √† la magie des fleurs blanches. Son accord lact√© et musqu√© √©voque une douceur enveloppante, tandis que ses notes florales et gourmandes cr√©ent une aura myst√©rieuse et envo√ªtante. Un parfum mixte qui incarne l\'amour et le myst√®re, parfait pour ceux qui souhaitent se connecter √† leur imaginaire et √† leur cr√©ativit√©.',
        price: 190,
        volume: 100,
        topNotes: ['Graine d\'ambrette', 'Accord lact√©'],
        heartNotes: ['Jasmin', 'Tub√©reuse', 'Encens'],
        baseNotes: ['F√®ve tonka', 'Cacao', 'Vanille musqu√©e'],
        brandId: brandMap.get('Les Liquides Imaginaires')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Numero 5',
        description: 'Rosendo Mateu 5, c\'est ce moment intense o√π une explosion d\'√©pices et de fleurs envo√ªtantes se transforme en un sillage chaud, musqu√© et l√©g√®rement gourmand. Une fragrance charnelle, myst√©rieuse et sophistiqu√©e ‚Äî id√©ale pour une soir√©e intime ou pour laisser une impression captivante.',
        price: 140,
        volume: 100,
        topNotes: ['√©pices', 'poivre noir', 'cardamome', 'fleurs exotiques (jasmin, muguet, rose)'],
        heartNotes: ['≈ìillet', 'bois de c√®dre', 'patchouli', 'cuir'],
        baseNotes: ['ambre', 'musc', 'vanille', 'f√®ve tonka', 'benjoin (et m√™me accord fraise gourmand)'],
        brandId: brandMap.get('Rosendo Mateu')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Instant Crush',
        description: 'Imaginez-vous lors d\'une soir√©e en ext√©rieur, v√™tue d\'un trench chic. Une bouff√©e chaleureuse de safran et d\'agrume s\'√©lance, suivie d\'un c≈ìur floral somptueux avant de s\'√©panouir en un sillage sensuel de vanille et de bois creux. Instant Crush capte l\'attention ‚Äî un parfum audacieux, √† la fois chaud et frais.',
        price: 100,
        volume: 120,
        topNotes: ['safran', 'gingembre', 'mandarine & bergamote siciliennes'],
        heartNotes: ['amberwood', 'rose du Maroc', 'jasmin d\'√âgypte', 'patchouli indon√©sien'],
        baseNotes: ['vanille de Madagascar', 'santal', 'musc blanc', 'mousse de ch√™ne'],
        brandId: brandMap.get('Mancera')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Arabians Tonka',
        description: 'Arabians Tonka est une explosion gourmande et intense : safran √©pic√© et oud chaud s\'unissent √† la douceur envo√ªtante de la tonka et du sucre. Un parfum sign√© niche, chaud et sensuel, avec un sillage incroyable.',
        price: 100,
        volume: 100,
        topNotes: ['safran', 'bergamote'],
        heartNotes: ['oud', 'rose de Bulgarie'],
        baseNotes: ['f√®ve tonka', 'sucre de canne', 'ambre', 'musc blanc', 'mousse de ch√™ne'],
        brandId: brandMap.get('Montale')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Almaz',
        description: 'Almaz est une explosion fruit√©e et gourmande ‚Äî bergamote et cassis frais en t√™te, √©voluant vers un c≈ìur floral cr√©meux, avant un fond chaud de vanille, tonka et musc doux. Une fragrance unisexe lumineuse et d√©licate, id√©ale tous les jours, avec ce petit plus luxe discret.',
        price: 150,
        volume: 100,
        topNotes: ['bergamote', 'cassis', 'citron d\'Amalfi', 'mandarine'],
        heartNotes: ['framboise', 'h√©liotrope', 'jasmin/iris', 'rose turque'],
        baseNotes: ['musc', 'bois (santal)', 'vanille de Madagascar', 'f√®ve tonka', 'ambre', 'sucr√© brun/caroon'],
        brandId: brandMap.get('Kajal')!,
        categoryId: categoryMap.get('Fruit√©')!,
    },
    {
        name: 'Hacivat',
        description: 'Hacivat, c\'est l\'√©clat d\'un cocktail fruit√© ‚Äì ananas juteux, agrumes p√©tillants ‚Äì qui s\'adoucit en un c≈ìur bois√© floral avant de s\'ancrer dans un sillage sec, profond et raffin√©. Un chypre moderne, unisexe, √† la tenue impressionnante.',
        price: 160,
        volume: 100,
        topNotes: ['bergamote', 'ananas', 'pamplemousse'],
        heartNotes: ['jasmin', 'patchouli', 'c√®dre'],
        baseNotes: ['clearwood¬Æ (bois sec)', 'mousse de ch√™ne', 'bois bois√©'],
        brandId: brandMap.get('Nishane')!,
        categoryId: categoryMap.get('Fruit√©')!,
    },
    {
        name: 'Lune Feline',
        description: 'Lune F√©line est une vanille fum√©e et cuir√©e, magnifi√©e par des √©pices chaudes et des bois profonds. Une vanille sauvage, envelopp√©e d\'un souffle balsamique et animal ‚Äî id√©ale pour les soir√©es d\'automne et d\'hiver, √† porter avec audace.',
        price: 150,
        volume: 100,
        topNotes: ['cannelle', 'cardamome', 'poivre rose ‚Äì l\'ouverture est √©pic√©e et vibrante'],
        heartNotes: ['c√®dre', 'ambre gris', 'styrax', 'notes bois√©es et vertes ‚Äì c≈ìur dense et somptueux'],
        baseNotes: ['vanille de Tahiti', 'baume du P√©rou', 'musc ‚Äì sillage gourmand et animal'],
        brandId: brandMap.get('Atelier des Ors')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Vanilla Island',
        description: 'Vanilla Island, c\'est un voyage sensoriel : l\'√©clat rafra√Æchissant de la bergamote, suivi d\'un bouquet floral exotique, avant une finale enveloppante de vanille ambr√©e. Parfait pour une ambiance estivale et √©l√©gante autour de soi, √† tout moment.',
        price: 130,
        volume: 100,
        topNotes: ['bergamote (ouverture vive et lumineuse)'],
        heartNotes: ['fleurs tropicales exotiques (bouquet flamboyant)'],
        baseNotes: ['vanille intense et chaleureuse (finale sensuelle et orientale)'],
        brandId: brandMap.get('Les Princes Du Golfe')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Emeraude Gourmande',
        description: 'Emeraude Gourmande est un voyage exotique : l\'intensit√© gourmande de la noix de coco, du caramel et des fruits rouges, adoucie par des fleurs blanches fra√Æches, se pose sur une base chaleureuse et enveloppante de musc et vanille. Un parfum mixte, solaire et sensuel, parfait √† porter en toute saison pour √©voquer l\'√©vasion.',
        price: 50,
        volume: 50,
        topNotes: ['noix de coco', 'caramel', 'bergamote', 'orange', 'fruits rouges'],
        heartNotes: ['jasmin sambac', 'fleurs d\'oranger', 'patchouli'],
        baseNotes: ['musc moderne', 'vanille'],
        brandId: brandMap.get('Les Princes Du Golfe')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Musc Vanille',
        description: 'Musc Vanille est un parfum chaleureux et gourmand o√π les agrumes frais s\'ouvrent sur un c≈ìur musqu√© enrichi de nuances pralin√©es, avant de s\'√©panouir en une vanille douce et ambr√©e. Une fragrance r√©confortante, parfaite pour un moment intime, qui enveloppe d√©licatement la peau d\'un voile sucr√© et r√©confortant.',
        price: 50,
        volume: 50,
        topNotes: ['bergamote', 'orange douce'],
        heartNotes: ['musc blanc', 'fleurs blanches', 'pralin√© gourmand'],
        baseNotes: ['vanille gourmande', 'ambre', 'bois blancs'],
        brandId: brandMap.get('Les Princes Du Golfe')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Desir de Nuit',
        description: 'Desir de Nuit est une fragrance envo√ªtante o√π la douceur de la f√®ve tonka s\'ouvre sur un c≈ìur floral √©l√©gant d\'iris et de jasmin, soutenu par la profondeur du c√®dre. En fond, les notes chaleureuses d\'amandes et de bois de santal apportent une touche orientale et sensuelle. Ce parfum mixte, √† la fois myst√©rieux et raffin√©, est id√©al pour les soir√©es sp√©ciales ou les moments o√π l\'on souhaite laisser une empreinte olfactive m√©morable.',
        price: 40,
        volume: 50,
        topNotes: ['f√®ve tonka'],
        heartNotes: ['iris', 'jasmin', 'c√®dre'],
        baseNotes: ['amandes', 'bois de santal'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Bonbec',
        description: 'Bonbec est un parfum gourmand et fruit√© qui m√™le fra√Æcheur des agrumes et cassis √† un c≈ìur floral d√©licat, avant de laisser s\'√©panouir un fond chaleureux de caramel, vanille et musc. Une joyeuse douceur de vivre, douce et √©l√©gante, parfaitement raffin√©e au quotidien.',
        price: 40,
        volume: 50,
        topNotes: ['bergamote', 'mandarine', 'cassis'],
        heartNotes: ['jasmin', 'rose', 'fruits rouges'],
        baseNotes: ['caramel', 'vanille', 'musc'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Sucre Pink',
        description: 'Sucre Pink est une gourmandise olfactive qui d√©bute par une explosion fruit√©e de framboise et cassis, suivie d\'un c≈ìur floral d√©licat de rose et jasmin. Le fond vanille et caramel, adouci par le musc, apporte une douceur chaleureuse et addictive. Parfait pour ceux qui aiment les parfums sucr√©s, f√©minins et √©l√©gants.',
        price: 40,
        volume: 50,
        topNotes: ['framboise', 'cassis'],
        heartNotes: ['rose', 'jasmin'],
        baseNotes: ['vanille', 'caramel', 'musc'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Halim',
        description: 'Halim est une fragrance gourmande et sensuelle qui s\'ouvre sur la douceur chaleureuse du sucre roux, √©voluant vers un c≈ìur enveloppant de vanille. En fond, l\'orchid√©e apporte une touche florale raffin√©e, cr√©ant un parfum √† la fois doux et √©l√©gant. Parfait pour les moments o√π l\'on souhaite se sentir envelopp√© de chaleur et de confort.',
        price: 40,
        volume: 50,
        topNotes: ['sucre roux'],
        heartNotes: ['vanille'],
        baseNotes: ['orchid√©e'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
    {
        name: 'Janeiro',
        description: 'Janeiro est une fragrance fra√Æche, lumineuse et florale. L\'ouverture vive d\'agrumes et d\'√©pices laisse place √† un c≈ìur d√©licat m√™lant jasmin, muguet et fleur d\'oranger. La base musqu√©e et bois√©e apporte une √©l√©gance douce et bois√©e pour un usage quotidien. Il √©voque la vitalit√© et la douceur d\'un matin ensoleill√©.',
        price: 40,
        volume: 50,
        topNotes: ['bergamote', 'citron', 'poivre rose'],
        heartNotes: ['jasmin', 'muguet', 'fleur d\'oranger'],
        baseNotes: ['musc blanc', 'c√®dre', 'ambre blanc'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Frais')!,
    },
    {
        name: 'Buteur',
        description: 'Buteur est une fragrance estivale et sensuelle qui s\'ouvre sur des notes acidul√©es et fougueuses d\'orange, le citron de Sicile et la bergamote de Calabre. Son voyage se poursuit gr√¢ce √† des notes de c≈ìur fruit√©es et enivrantes, avant de d√©voiler un fond s√©ducteur m√™lant musc blanc, vanille de Madagascar et ambre. Ce parfum est id√©al pour les journ√©es d\'√©t√©, frais, p√©tillant et ensoleill√©, parfait pour ceux qui recherchent une fragrance qui les rend irr√©sistibles.',
        price: 40,
        volume: 50,
        topNotes: ['orange', 'citron de Sicile', 'bergamote de Calabre'],
        heartNotes: ['fruits'],
        baseNotes: ['musc blanc', 'vanille de Madagascar', 'ambre'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Fruit√©')!,
    },
    {
        name: 'Retourne-Toi',
        description: 'Retourne Toi est une fragrance envo√ªtante et myst√©rieuse qui s√©duit d√®s les premi√®res notes. Son ouverture douce et intrigante de caramel, fruits rouges et p√™che est rehauss√©e par la chaleur √©pic√©e du safran et la profondeur audacieuse du cuir. Au c≈ìur, des accords de poivre rose, de gingembre et de bois pr√©cieux s\'entrelacent pour cr√©er une √©nergie vibrante, entre intensit√© et raffinement. En fond, la richesse sensuelle du oud s\'accorde avec le benjoin, le baumier du P√©rou, tandis que le musc prolonge une sensation enveloppante et addictive. Ce parfum est une exp√©rience olfactive inoubliable qui √©veille les sens.',
        price: 40,
        volume: 50,
        topNotes: ['caramel', 'fruits rouges', 'p√™che', 'safran', 'cuir'],
        heartNotes: ['poivre rose', 'notes bois√©es', 'gingembre'],
        baseNotes: ['vanille', 'oud', 'benjoin', 'musc', 'baumier du P√©rou'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Oriental')!,
    },
    {
        name: 'Vanille Speculoos',
        description: 'Vanille Sp√©culos est une fragrance gourmande et chaleureuse qui √©voque la douceur des biscuits √©pic√©s. Son ouverture de musc blanc est suivie par un c≈ìur bois√© de santal, tandis que les notes de fond de pomme et d\'oud apportent une touche fruit√©e et bois√©e. Ce parfum est id√©al pour ceux qui recherchent une exp√©rience olfactive r√©confortante et nostalgique.',
        price: 40,
        volume: 50,
        topNotes: ['musc blanc'],
        heartNotes: ['bois de santal'],
        baseNotes: ['pomme', 'oud'],
        brandId: brandMap.get('Maison Berliner')!,
        categoryId: categoryMap.get('Gourmand')!,
    },
  ];

  const finalProducts = productsData.map(p => ({
    ...p,
    slug: toSlug(p.name),
    originalPrice: p.price + 15,
    images: [`/products/${toSlug(p.name)}.png`],
    concentration: 'Eau de Parfum',
    gender: Gender.UNISEX,
    featured: Math.random() > 0.5,
    inStock: true,
  }))

  for (const productData of finalProducts) {
    await prisma.product.create({
      data: productData,
    });
  }

  console.log(`üß¥ ${finalProducts.length} produits cr√©√©s.`);

  const createdProducts = await prisma.product.findMany({ take: 5 });
  for (const product of createdProducts) {
    await prisma.favorite.create({
      data: {
        userId: testUser.id,
        productId: product.id,
      },
    });
  }
  console.log(`‚ù§Ô∏è ${createdProducts.length} favoris cr√©√©s pour l'utilisateur de test.`);

  console.log('‚úÖ Seed termin√© avec succ√®s !');
}

main()
  .catch((e) => {
    console.error('‚ùå Erreur lors du seed:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  }); 